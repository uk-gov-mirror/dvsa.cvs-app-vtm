<div class="govuk-form-group">
  @if (controlLabel()) {
    <label class="govuk-label govuk-label--m" tag for="{{ id }}" [id]="labelId">
      {{ controlLabel() }}
      @if (tags().length) {
        <div class="flex gap-2">
          @for (tag of tags(); track tag) {
            <app-tag [type]="tag.colour">{{ tag.label }}</app-tag>
          }
        </div>
      }
    </label>
  }

  @if (controlHint()) {
    <div class="govuk-hint" id="{{ hintId }}"> {{ controlHint() }}</div>
  }

  @if (hasError) {
    @let firstError = (control?.errors | keyvalue)?.[0]?.value;
    <p class="govuk-error-message" id="{{ errorId }}">
      <span class="govuk-visually-hidden">Error: </span>
      <span>{{ (typeof firstError === 'string' ? firstError : firstError.error) }}</span>
    </p>
  }

  <select
    id="{{ id }}"
    name="{{ id }}"
    [attr.aria-describedby]="hintId"
    [attr.aria-labelledby]="labelId"
    [attr.data-testid]="id"
    [class.govuk-radios__input--error]="hasError"
    [(ngModel)]="value"
    (ngModelChange)="onChange($event)"
    (blur)="onBlur($event)"
    [class]="style"
    [disabled]="disabled()"
  >
    @if (allowNull()) {
      <option [ngValue]="null"></option>
    }

    @if (defaultOption()) {
      <option [selected]="true" [ngValue]="null">{{ defaultOption() }}</option>
    }
    @for (option of options(); track option) {
      <option [ngValue]="option.value">{{ option.label }}</option>
    }
  </select>
</div>
