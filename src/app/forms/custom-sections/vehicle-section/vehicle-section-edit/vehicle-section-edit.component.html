<div [formGroup]="form">
  <!--  Vehicle Type -->
  <div *ngIf="shouldDisplayFormControl('techRecord_vehicleType')" class="govuk-form-group-input">
    <h1>
      <label tag for="techRecord_vehicleType"> Vehicle type <div>
        <app-tag [type]="TagType.RED">{{ TagTypeLabels.REQUIRED }}</app-tag>
      </div></label>
    </h1>
    <input id="techRecord_vehicleType" [width]="FormNodeWidth.XS" govukInput formControlName="techRecord_vehicleType" />
  </div>

  <!--  Date of First Registration -->
  <app-date-controls *ngIf="shouldDisplayFormControl('techRecord_regnDate')" formControlName="techRecord_regnDate" #dateFirstReg>
    <div class="govuk-form-group-date" [formGroup]="dateFirstReg.form">
      <fieldset role="group">
        <legend>
          Date of first registration
          <app-tag [type]="TagType.PURPLE">{{ TagTypeLabels.PLATES }}</app-tag>
        </legend>
        <app-control-errors elementId="techRecord_regnDate-error" [control]="$any(form.controls.techRecord_regnDate)" />
        <div id="techRecord_regnDate">
          <div>
            <div>
              <label id="techRecord_regnDate-day-label">Day</label>
              <input class="govuk-input--width-2" govukDateInput="techRecord_regnDate" formControlName="day" />
            </div>
          </div>
          <div>
            <div>
              <label id="techRecord_regnDate-month-label">Month</label>
              <input class="govuk-input--width-2" govukDateInput="techRecord_regnDate" formControlName="month" />
            </div>
          </div>
          <div>
            <div>
              <label id="techRecord_regnDate-year-label">Year</label>
              <input class="govuk-input--width-4" govukDateInput="techRecord_regnDate" formControlName="year" />
            </div>
          </div>
        </div>
      </fieldset>
    </div>
  </app-date-controls>

  <!--  Year of manufacture -->
  <div *ngIf="shouldDisplayFormControl('techRecord_manufactureYear')" class="govuk-form-group-input">
    <h1>
      <label tag id="techRecord_manufactureYear-label">
        Year of manufacture
        <div>
          <app-tag [type]="TagType.PURPLE">{{ TagTypeLabels.PLATES }}</app-tag>
        </div>
      </label>
    </h1>
    <input
      appNumberOnly
      inputmode="numeric"
      type="number"
      [width]="FormNodeWidth.XS"
      govukInput
      formControlName="techRecord_manufactureYear" />
  </div>

  <!--  Number of axles -->
  <div *ngIf="shouldDisplayFormControl('techRecord_noOfAxles')" class="govuk-form-group-input">
    <h1>
      <label tag for="techRecord_noOfAxles"> Number of axles <div>
        <app-tag [type]="TagType.RED">{{ TagTypeLabels.REQUIRED }}</app-tag>
      </div></label>
    </h1>
    <input id="techRecord_noOfAxles" [width]="FormNodeWidth.XXS" govukInput formControlName="techRecord_noOfAxles" />
  </div>

  <!-- Vehicle Subclass (LGV/CAR only) -->
  <ng-container *ngIf="shouldDisplayFormControl('techRecord_vehicleSubclass')">
    <govuk-checkbox-group label="Vehicle Subclass" formControlName="techRecord_vehicleSubclass" [options]="subClassOptions" />
  </ng-container>

  <div class="flex-row">
    <!-- Speed limiter exempt -->
    <div *ngIf="shouldDisplayFormControl('techRecord_speedLimiterMrk')" class="govuk-form-group-radio">
      <fieldset>
        <legend>
          <h1 tag>
            Speed limiter exempt
            <div>
              <app-tag [type]="TagType.PURPLE">{{ TagTypeLabels.PLATES }}</app-tag>
            </div>
          </h1>
        </legend>
        <div data-module="govuk-radios">
          <div *ngFor="let option of ExemptOrNotOptions">
            <input
              id="techRecord_speedLimiterMrk-{{ option.value }}-radio"
              govukRadio
              type="radio"
              formControlName="techRecord_speedLimiterMrk"
              [value]="option.value"
            />
            <label
             for="techRecord_speedLimiterMrk-{{ option.value }}-radio"
            >
              {{ option.label }}
            </label>
          </div>
        </div>
      </fieldset>
    </div>

    <!-- Tacho exempt -->
    <div *ngIf="shouldDisplayFormControl('techRecord_tachoExemptMrk')" class="govuk-form-group-radio">
      <fieldset>
        <legend>
          <h1>
            Tacho exempt
          </h1>
        </legend>
        <div data-module="govuk-radios">
          <div *ngFor="let option of ExemptOrNotOptions">
            <input
              id="techRecord_tachoExemptMrk-{{ option.value }}-radio"
              formControlName="techRecord_tachoExemptMrk"
              [value]="option.value"
              govukRadio
              type="radio"
            />
            <label
              for="techRecord_tachoExemptMrk-{{ option.value }}-radio'"
            >
              {{ option.label }}
            </label>
          </div>
        </div>
      </fieldset>
    </div>
  </div>

  <!-- Euro standard -->
  <div *ngIf="shouldDisplayFormControl('techRecord_euroStandard')" class="govuk-form-group-radio">
    <fieldset>
      <legend>
        <h1>
          Euro standard
        </h1>
      </legend>
      <div data-module="govuk-radios">
        <div *ngFor="let option of euroStandardOptions">
          <input
            id="techRecord_euroStandard-{{ option.value }}-radio"
            formControlName="techRecord_euroStandard"
            [value]="option.value"
            govukRadio
            type="radio"
          />
          <label
            for="techRecord_euroStandard-{{ option.value }}-radio'"
          >
            {{ option.label }}
          </label>
        </div>
      </div>
    </fieldset>
  </div>


  <!-- Road friendly suspension -->
  <div *ngIf="shouldDisplayFormControl('techRecord_roadFriendly')" class="govuk-form-group-radio">
    <fieldset>
      <legend>
        <h1 tag>
          Road friendly suspension
          <div>
            <app-tag [type]="TagType.PURPLE">{{ TagTypeLabels.PLATES }}</app-tag>
          </div>
        </h1>
      </legend>
      <div data-module="govuk-radios">
        <div *ngFor="let option of ExemptOrNotOptions">
          <input
            govukRadio
            type="radio"
            id="techRecord_roadFriendly-{{ option.value }}-radio"
            formControlName="techRecord_roadFriendly"
            [value]="option.value"
          />
          <label
            for="techRecord_roadFriendly-{{ option.value }}-radio'"
          >
            {{ option.label }}
          </label>
        </div>
      </div>
    </fieldset>
  </div>

  <!-- Fuel / propulsion system -->
  <div *ngIf="shouldDisplayFormControl('techRecord_fuelPropulsionSystem')" class="govuk-form-group-select">
    <label> Fuel / propulsion system </label>
    <app-control-errors elementId="techRecord_fuelPropulsionSystem" [control]="$any(form.get('techRecord_fuelPropulsionSystem'))" />
    <select govukSelect formControlName="techRecord_fuelPropulsionSystem">
      <option [value]="option.value" *ngFor="let option of fuelPropulsionSystemOptions">{{ option.label }}</option>
    </select>
  </div>

  <!-- Drawbar coupling fitted -->
  <div *ngIf="shouldDisplayFormControl('techRecord_drawbarCouplingFitted')" class="govuk-form-group-radio">
    <fieldset>
      <legend>
        <h1>
          Drawbar coupling fitted
        </h1>
      </legend>
      <div data-module="govuk-radios">
        <div *ngFor="let option of YesNoOptions">
          <input
            govukRadio
            type="radio"
            id="techRecord_drawbarCouplingFitted-{{ option.value }}-radio"
            formControlName="techRecord_drawbarCouplingFitted"
            [value]="option.value"
          />
          <label
            for="techRecord_drawbarCouplingFitted-{{ option.value }}-radio'"
          >
            {{ option.label }}
          </label>
        </div>
      </div>
    </fieldset>
  </div>

<!--  Vehicle class (HGV/Motorcycle) -->
  <ng-container *ngIf="shouldDisplayFormControl('techRecord_vehicleClass_description')" [ngTemplateOutlet]="vehicleClass"></ng-container>


<!--  Vehicle configuration-->
  <div *ngIf="shouldDisplayFormControl('techRecord_vehicleConfiguration')" class="govuk-form-group-select">
    <label tag>
      Vehicle configuration
      <div>
        <app-tag [type]="TagType.RED">{{ TagTypeLabels.REQUIRED }}</app-tag>
      </div>
      <div>
        <app-tag [type]="TagType.PURPLE">{{ TagTypeLabels.PLATES }}</app-tag>
      </div>
    </label>
    <app-control-errors elementId="techRecord_vehicleConfiguration" [control]="$any(form.get('techRecord_vehicleConfiguration'))" />
    <select govukSelect formControlName="techRecord_vehicleConfiguration">
      <option [value]="option.value" *ngFor="let option of vehicleConfigurationOptions">{{ option.label }}</option>
    </select>
  </div>

<!-- Off road vehicle -->
  <div *ngIf="shouldDisplayFormControl('techRecord_offRoad')" class="govuk-form-group-radio">
    <fieldset>
      <legend>
        <h1>
          Off road vehicle
        </h1>
      </legend>
      <div data-module="govuk-radios">
        <div *ngFor="let option of YesNoOptions">
          <input
            govukRadio
            id="techRecord_offRoad-{{ option.value }}-radio"
            name="techRecord_offRoad-{{ option.value }}-radio"
            formControlName="techRecord_offRoad"
            [value]="option.value"
            type="radio"
          />
          <label
            for="techRecord_offRoad-{{ option.value }}-radio'"
          >
            {{ option.label }}
          </label>
        </div>
      </div>
    </fieldset>
  </div>

  <!-- EU Category -->
  <div *ngIf="shouldDisplayFormControl('techRecord_euVehicleCategory')" class="govuk-form-group-select">
    <label>EU vehicle category</label>
    <app-control-errors elementId="techRecord_euVehicleCategory" [control]="$any(form.get('techRecord_euVehicleCategory'))" />
    <select govukSelect [width]="FormNodeWidth.XXS" formControlName="techRecord_euVehicleCategory">
      <option [value]="option.value" *ngFor="let option of EUCategoryOptions">{{ option.label }}</option>
    </select>
  </div>

  <!-- Number of wheels (Motorcycle only) -->
  <ng-container *ngIf="techRecord().techRecord_vehicleType === VehicleTypes.MOTORCYCLE">
    <div *ngIf="shouldDisplayFormControl('techRecord_numberOfWheelsDriven')" class="govuk-form-group-input">
      <h1>
        <label tag for="techRecord_numberOfWheelsDriven"> Number of wheels <div>
          <app-tag [type]="TagType.RED">{{ TagTypeLabels.REQUIRED }}</app-tag>
        </div></label>
      </h1>
      <input id="techRecord_numberOfWheelsDriven" [width]="FormNodeWidth.XXS" govukInput formControlName="techRecord_numberOfWheelsDriven" />
    </div>
  </ng-container>

  <!-- Emission Limit -->
  <div *ngIf="shouldDisplayFormControl('techRecord_emissionsLimit')" class="govuk-form-group-input">
    <h1>
      <label tag for="techRecord_emissionsLimit">Emission limit (m-1) (plate value)</label>
    </h1>
    <app-control-errors elementId="techRecord_emissionsLimit" [control]="$any(form.get('techRecord_emissionsLimit'))" />
    <input type="number" spellcheck="false" id="techRecord_emissionsLimit" [width]="FormNodeWidth.XXS" govukInput formControlName="techRecord_emissionsLimit" />
  </div>

  <!-- PSV Only Fields -->
  <div class="govuk-form-group-split-controls" *ngIf="techRecord()?.techRecord_vehicleType === VehicleTypes.PSV">
    <h1>
      <label>Seats:</label>
    </h1>
    <div class="flex-row">
      <!-- Upper Deck -->
      <div class="govuk-form-group-input">
        <h1>
          <label tag for="techRecord_seatsUpperDeck">
            Upper deck
            <div>
              <app-tag [type]="TagType.RED">{{ TagTypeLabels.REQUIRED }}</app-tag>
            </div>
          </label>
        </h1>
        <app-control-errors elementId="techRecord_seatsUpperDeck" [control]="$any(form.get('techRecord_seatsUpperDeck'))" />
        <input appNumberOnly inputmode="numeric" type="number" spellcheck="false" id="techRecord_seatsUpperDeck" [width]="FormNodeWidth.XS" govukInput formControlName="techRecord_seatsUpperDeck" />
      </div>

      <!-- Lower Deck -->
      <div class="govuk-form-group-input">
        <h1>
          <label tag for="techRecord_seatsLowerDeck">
            Lower deck
            <div>
              <app-tag [type]="TagType.RED">{{ TagTypeLabels.REQUIRED }}</app-tag>
            </div>
          </label>
        </h1>
        <app-control-errors elementId="techRecord_seatsLowerDeck" [control]="$any(form.get('techRecord_seatsLowerDeck'))" />
        <input appNumberOnly inputmode="numeric" type="number" spellcheck="false" id="techRecord_seatsLowerDeck" [width]="FormNodeWidth.XS" govukInput formControlName="techRecord_seatsLowerDeck" />
      </div>
    </div>

    <!-- Standing Capacity -->
    <div class="govuk-form-group-input">
      <h1>
        <label tag for="techRecord_standingCapacity">Standing capacity</label>
      </h1>
      <app-control-errors elementId="techRecord_standingCapacity" [control]="$any(form.get('techRecord_standingCapacity'))" />
      <input type="number" spellcheck="false" id="techRecord_standingCapacity" [width]="FormNodeWidth.XXS" govukInput formControlName="techRecord_standingCapacity" />
    </div>

    <!-- Vehicle Class (PSV) -->
    <ng-template [ngTemplateOutlet]="vehicleClass"></ng-template>
  </div>


  <!-- Departmental vehicle marker -->
  <div *ngIf="shouldDisplayFormControl('techRecord_departmentalVehicleMarker')" class="govuk-form-group-radio">
    <fieldset>
      <legend>
        <h1>
          Departmental vehicle marker
        </h1>
      </legend>
      <div data-module="govuk-radios">
        <div *ngFor="let option of YesNoOptions">
          <input
            govukRadio
            id="techRecord_departmentalVehicleMarker-{{ option.value }}-radio"
            formControlName="techRecord_departmentalVehicleMarker"
            [value]="option.value"
            type="radio"
          />
          <label
            for="techRecord_departmentalVehicleMarker-{{ option.value }}-radio'"
          >
            {{ option.label }}
          </label>
        </div>
      </div>
    </fieldset>
  </div>

  <!-- Alteration marker -->
  <div *ngIf="shouldDisplayFormControl('techRecord_alterationMarker')" class="govuk-form-group-radio">
    <fieldset>
      <legend>
        <h1>
          Alteration marker
        </h1>
      </legend>
      <div data-module="govuk-radios">
        <div *ngFor="let option of YesNoOptions">
          <input
            govukRadio
            id="techRecord_alterationMarker-{{ option.value }}-radio"
            formControlName="techRecord_alterationMarker"
            [value]="option.value"
            type="radio"
          />
          <label
            for="techRecord_alterationMarker-{{ option.value }}-radio'"
          >
            {{ option.label }}
          </label>
        </div>
      </div>
    </fieldset>
  </div>

  <ng-template #vehicleClass>
    <div  class="govuk-form-group-select">
      <label tag>
        Vehicle class
        <div>
          <app-tag [type]="TagType.RED">{{ TagTypeLabels.REQUIRED }}</app-tag>
        </div>
      </label>
      <div *ngIf="techRecord()?.techRecord_vehicleType === VehicleTypes.PSV" class="govuk-hint">
        The Vehicle Class is calculated automatically based on the number of seats and standing capacity.
        Only change the Class if you need to
      </div>
      <app-control-errors elementId="techRecord_vehicleClass_description" [control]="$any(form.get('techRecord_vehicleClass_description'))" />
      <select govukSelect formControlName="techRecord_vehicleClass_description">
        <option [value]="option.value" *ngFor="let option of vehicleClassDescriptionOptions">{{ option.label }}</option>
      </select>
    </div>
  </ng-template>
</div>
